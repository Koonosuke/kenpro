# Terraform Remote State Backend Configuration Example
# âš ï¸ ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚³ãƒ”ãƒ¼ã—ã¦ backend.tf ã‚’ä½œæˆã—ã¦ãã ã•ã„
# âš ï¸ backend.tf ã¯ .gitignore ã«è¿½åŠ ã—ã¦Gitã«ã‚³ãƒŸãƒƒãƒˆã—ãªã„ã§ãã ã•ã„
#
# ã‚³ãƒ”ãƒ¼ã‚³ãƒãƒ³ãƒ‰:
#   Copy-Item backend.tf.example backend.tf
#
# ãã®å¾Œã€YOUR_ACCOUNT_ID ã‚’è‡ªåˆ†ã®AWSã‚¢ã‚«ã‚¦ãƒ³ãƒˆIDã«ç½®ãæ›ãˆã¦ãã ã•ã„

terraform {
  backend "s3" {
    # S3ãƒã‚±ãƒƒãƒˆåï¼ˆã‚°ãƒ­ãƒ¼ãƒãƒ«ã§ä¸€æ„ã§ã‚ã‚Œã°ä½•ã§ã‚‚OKï¼‰
    # 
    # æ¨å¥¨: ã‚·ãƒ³ãƒ—ãƒ«ã§ã‚ã‹ã‚Šã‚„ã™ã„åå‰
    #   ä¾‹: "your-project-terraform-state-yourname"
    #
    # ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå + è­˜åˆ¥å­ãŒãŠã™ã™ã‚:
    #   bucket = "recycle-system-terraform-state-kenpro"
    #   bucket = "myapp-terraform-state-dev"
    #   bucket = "company-project-tfstate"
    #
    # ã‚¢ã‚«ã‚¦ãƒ³ãƒˆIDã‚’å«ã‚ã‚‹ã“ã¨ã‚‚å¯èƒ½ï¼ˆè¤‡æ•°ã‚¢ã‚«ã‚¦ãƒ³ãƒˆç®¡ç†æ™‚ã«ä¾¿åˆ©ï¼‰:
    #   bucket = "recycle-system-terraform-state-123456789012"
    #
    bucket = "recycle-system-terraform-state-YOUR_NAME"
    
    # stateãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹ï¼ˆç’°å¢ƒã”ã¨ã«åˆ†ã‘ã‚‹ï¼‰
    # devç’°å¢ƒ: dev/terraform.tfstate
    # prodç’°å¢ƒ: prod/terraform.tfstate
    key = "dev/terraform.tfstate"
    
    # AWSãƒªãƒ¼ã‚¸ãƒ§ãƒ³
    region = "us-east-1"
    
    # DynamoDBãƒ†ãƒ¼ãƒ–ãƒ«åï¼ˆãƒ­ãƒƒã‚¯ç®¡ç†ç”¨ï¼‰
    dynamodb_table = "terraform-state-lock"
    
    # ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰æš—å·åŒ–ã‚’æœ‰åŠ¹åŒ–
    encrypt = true
  }
}

# ğŸ“ ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ‰‹é †:
#
# 1. ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚³ãƒ”ãƒ¼:
#    Copy-Item backend.tf.example backend.tf
#
# 2. backend.tf ã®ãƒã‚±ãƒƒãƒˆåã‚’å¤‰æ›´:
#    bucket = "recycle-system-terraform-state-YOUR_NAME"
#    ä¾‹: bucket = "recycle-system-terraform-state-kenpro"
#
# 3. scripts/setup-backend-storage.ps1 ã‚‚åŒã˜ãƒã‚±ãƒƒãƒˆåã«å¤‰æ›´
#
# 4. S3ãƒã‚±ãƒƒãƒˆã¨DynamoDBãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ä½œæˆ:
#    .\scripts\setup-backend-storage.ps1
#
# 5. Terraformã‚’åˆæœŸåŒ–:
#    terraform init
#
# 6. ï¼ˆæ—¢å­˜ã®stateãŒã‚ã‚‹å ´åˆï¼‰stateã‚’ç§»è¡Œ:
#    terraform init -migrate-state

